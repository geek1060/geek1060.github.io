<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Shreyas G | Space Operations Digital Twin</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Three.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<!-- MediaPipe Hands -->
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Inter&display=swap" rel="stylesheet">

<style>
body { margin:0; background:#000814; color:#b8d7ff; overflow:hidden; font-family:Inter; }

/* NASA Grid */
body::before {
  content:""; position:fixed; inset:0;
  background:linear-gradient(#0a1a3333 1px, transparent 1px),
             linear-gradient(90deg,#0a1a3333 1px, transparent 1px);
  background-size:80px 80px; z-index:-1;
}

/* Holographic Panels */
.panel {
  position:fixed;
  background:rgba(5,15,40,0.6);
  border:1px solid rgba(120,180,255,0.2);
  backdrop-filter:blur(12px);
  padding:14px;
  box-shadow:inset 0 0 20px rgba(100,150,255,0.05);
}

#header { top:20px; left:20px; width:420px; }
#telemetry { top:20px; right:20px; width:380px; }
#console { bottom:20px; left:20px; width:70%; font-family:monospace; font-size:13px; color:#7effff; }

h1 { font-family:Orbitron; font-size:20px; }
h2 { font-family:Orbitron; font-size:14px; color:#9bc4ff; }

.tag { border:1px solid rgba(120,180,255,0.3); padding:4px 8px; margin:3px; display:inline-block; font-size:12px; }

/* Webcam hidden */
#inputVideo { display:none; }
</style>
</head>

<body>

<video id="inputVideo" autoplay></video>

<div id="header" class="panel">
<h1>Shreyas G</h1>
<p>Space Operations & Digital Twin Research</p>
<div class="tag">Orbital Digital Twin</div>
<div class="tag">Space Traffic Management</div>
<div class="tag">AI Defence Systems</div>
</div>

<div id="telemetry" class="panel">
<h2>Mission Telemetry</h2>
<p>Earth Rotation Control: Gesture Pinch</p>
<p>Hand Position â†’ Camera Navigation (future)</p>
</div>

<div id="console" class="panel">
> ORBITAL DIGITAL TWIN ONLINE<br>
> HAND CONTROL SYSTEM ACTIVE<br>
> USER AUTHENTICATED: SHREYAS G<br>
</div>

<script>
// ================= THREE.JS EARTH =================
let scene = new THREE.Scene();
let camera = new THREE.PerspectiveCamera(50, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.z = 3.5;

let renderer = new THREE.WebGLRenderer({antialias:true, alpha:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Earth
let earthGeo = new THREE.SphereGeometry(1,64,64);
let tex = new THREE.TextureLoader().load("https://threejs.org/examples/textures/land_ocean_ice_cloud_2048.jpg");
let earthMat = new THREE.MeshPhongMaterial({map:tex});
let earth = new THREE.Mesh(earthGeo, earthMat);
scene.add(earth);

// Lights
let light = new THREE.DirectionalLight(0xffffff,1);
light.position.set(5,2,5);
scene.add(light);
scene.add(new THREE.AmbientLight(0x223344));

// Orbits
let orbitMat = new THREE.LineBasicMaterial({color:0x446688});
for(let i=1;i<=3;i++){
  let orbitGeo = new THREE.RingGeometry(1.3+i*0.2,1.3+i*0.2,128);
  let orbit = new THREE.Mesh(orbitGeo, orbitMat);
  orbit.rotation.x=Math.PI/2;
  scene.add(orbit);
}

// Animation
function animate(){
  requestAnimationFrame(animate);
  earth.rotation.y += 0.0002;
  renderer.render(scene,camera);
}
animate();

window.addEventListener("resize", ()=>{
  camera.aspect=window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});

// ================= HAND GESTURE CONTROL =================
const videoElement = document.getElementById("inputVideo");

const hands = new Hands({
  locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`
});

hands.setOptions({
  maxNumHands:1,
  modelComplexity:1,
  minDetectionConfidence:0.7,
  minTrackingConfidence:0.7
});

// Pinch Detection
let lastX = null;
hands.onResults(results => {
  if(!results.multiHandLandmarks) return;

  let lm = results.multiHandLandmarks[0];
  let thumb = lm[4];
  let index = lm[8];

  let dx = thumb.x - index.x;
  let dy = thumb.y - index.y;
  let pinchDist = Math.sqrt(dx*dx + dy*dy);

  // Pinch detected
  if(pinchDist < 0.04){
    if(lastX !== null){
      let delta = index.x - lastX;
      earth.rotation.y += delta * 5; // rotate Earth with fingers
    }
    lastX = index.x;
  } else {
    lastX = null;
  }
});

// Webcam
const cameraFeed = new Camera(videoElement, {
  onFrame: async () => await hands.send({image: videoElement}),
  width:640, height:480
});
cameraFeed.start();
</script>

</body>
</html>
